<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.example.payroll_project.controller.AttendanceController"
      spacing="24">
    

    <HBox alignment="CENTER_LEFT" spacing="20">
        <VBox spacing="4">
            <Label text="Attendance Management" styleClass="card-title" style="-fx-font-size: 28px;"/>
            <Label text="Import and manage attendance records from FA2000 biometric scanner" 
                   styleClass="card-subtitle"/>
        </VBox>
        
        <Region HBox.hgrow="ALWAYS"/>
        
        <HBox spacing="10">
            <Button text="Import FA2000 CSV" styleClass="button-primary" 
                    onAction="#handleImportCSV"/>
            <Button text="Export Report" styleClass="button-secondary" 
                    onAction="#handleExport"/>
        </HBox>
    </HBox>

    <GridPane hgap="20" vgap="20">
        <columnConstraints>
            <ColumnConstraints percentWidth="25"/>
            <ColumnConstraints percentWidth="25"/>
            <ColumnConstraints percentWidth="25"/>
            <ColumnConstraints percentWidth="25"/>
        </columnConstraints>
        
        <VBox styleClass="stat-card" spacing="12" GridPane.columnIndex="0">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="ðŸ“¥" style="-fx-font-size: 24px;"/>
                <Label text="Last Import" styleClass="stat-label"/>
            </HBox>
            <Label fx:id="lastImportLabel" text="No imports yet" 
                   style="-fx-font-size: 18px; -fx-font-weight: 600;"/>
            <Label fx:id="lastImportDateLabel" text="-" styleClass="card-subtitle"/>
        </VBox>
        
        <VBox styleClass="stat-card" spacing="12" GridPane.columnIndex="1">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="âœ…" style="-fx-font-size: 24px;"/>
                <Label text="Valid Records" styleClass="stat-label"/>
            </HBox>
            <Label fx:id="validRecordsLabel" text="0" styleClass="stat-value"/>
            <Label text="Records processed" styleClass="card-subtitle"/>
        </VBox>
        
        <VBox styleClass="stat-card" spacing="12" GridPane.columnIndex="2">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="âš ï¸" style="-fx-font-size: 24px;"/>
                <Label text="Anomalies" styleClass="stat-label"/>
            </HBox>
            <Label fx:id="anomaliesLabel" text="0" styleClass="stat-value"/>
            <Label text="Requires attention" styleClass="card-subtitle"/>
        </VBox>
        
        <VBox styleClass="stat-card" spacing="12" GridPane.columnIndex="3">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="ðŸ“Š" style="-fx-font-size: 24px;"/>
                <Label text="Attendance Rate" styleClass="stat-label"/>
            </HBox>
            <Label fx:id="attendanceRateLabel" text="0%" styleClass="stat-value"/>
            <Label text="This month" styleClass="card-subtitle"/>
        </VBox>
    </GridPane>

    <VBox styleClass="card" spacing="16">
        <Label text="Filter by Date Range" styleClass="card-title"/>
        <HBox spacing="12" alignment="CENTER_LEFT">
            <DatePicker fx:id="startDatePicker" promptText="Start Date"/>
            <Label text="to"/>
            <DatePicker fx:id="endDatePicker" promptText="End Date"/>
            
            <Button text="Apply" styleClass="button-primary" onAction="#handleApplyDateFilter"/>
            <Button text="Today" styleClass="button-secondary" onAction="#handleFilterToday"/>
            <Button text="This Week" styleClass="button-secondary" onAction="#handleFilterThisWeek"/>
            <Button text="This Month" styleClass="button-secondary" onAction="#handleFilterThisMonth"/>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <CheckBox fx:id="showAnomaliesOnly" 
                      text="Show Anomalies Only"
                      onAction="#handleFilterAnomalies"/>
        </HBox>
    </VBox>

    <VBox styleClass="card" spacing="16" VBox.vgrow="ALWAYS">
        <HBox styleClass="card-header" alignment="CENTER_LEFT" spacing="15">
            <VBox spacing="4">
                <Label text="Attendance Records" styleClass="card-title"/>
                <Label fx:id="recordCountLabel" text="0 records" styleClass="card-subtitle"/>
            </VBox>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Button text="Validate All" styleClass="button-secondary" 
                    onAction="#handleValidateAll"/>
            <Button text="Refresh" styleClass="button-secondary" 
                    onAction="#handleRefresh"/>
        </HBox>
        
        <TableView fx:id="attendanceTable" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="employeeCodeColumn" text="Emp. Code" prefWidth="80"/>
                <TableColumn fx:id="employeeNameColumn" text="Employee Name" prefWidth="150"/>
                <TableColumn fx:id="dateColumn" text="Date" prefWidth="100"/>
                <TableColumn fx:id="timeIn1Column" text="Time In" prefWidth="80"/>
                <TableColumn fx:id="timeOut1Column" text="Lunch Out" prefWidth="80"/>
                <TableColumn fx:id="timeIn2Column" text="Lunch In" prefWidth="80"/>
                <TableColumn fx:id="timeOut2Column" text="Time Out" prefWidth="80"/>
                <TableColumn fx:id="regularHoursColumn" text="Regular Hrs" prefWidth="80"/>
                <TableColumn fx:id="overtimeColumn" text="OT Hrs" prefWidth="70"/>
                <TableColumn fx:id="statusColumn" text="Status" prefWidth="100"/>
                <TableColumn fx:id="actionsColumn" text="Actions" prefWidth="100"/>
            </columns>
            <placeholder>
                <VBox alignment="CENTER" spacing="10" style="-fx-padding: 40px;">
                    <Label text="No attendance records found" 
                           style="-fx-font-size: 16px; -fx-text-fill: #6B7280;"/>
                    <Label text="Import a CSV file from FA2000 scanner to get started" 
                           styleClass="card-subtitle"/>
                    <Button text="Import Now" styleClass="button-primary" 
                            onAction="#handleImportCSV"
                            style="-fx-padding: 10px 20px; -fx-margin-top: 10px;"/>
                </VBox>
            </placeholder>
        </TableView>

        <HBox alignment="CENTER" spacing="10">
            <Button text="Previous" styleClass="button-secondary" onAction="#handlePreviousPage"/>
            <Label fx:id="pageLabel" text="Page 1 of 1"/>
            <Button text="Next" styleClass="button-secondary" onAction="#handleNextPage"/>
        </HBox>
    </VBox>
    
    <!-- Import Instructions Card -->
    <VBox styleClass="card" spacing="12" style="-fx-background-color: #DBEAFE;">
        <HBox alignment="CENTER_LEFT" spacing="12">
            <Label text="â„¹ï¸" style="-fx-font-size: 20px;"/>
            <VBox spacing="6">
                <Label text="FA2000 CSV Import Instructions" 
                       style="-fx-font-weight: 600; -fx-text-fill: #1E40AF;"/>
                <Label text="1. Export attendance data from your FA2000 biometric scanner as CSV" 
                       style="-fx-text-fill: #1E40AF;"/>
                <Label text="2. Click 'Import FA2000 CSV' and select the exported file" 
                       style="-fx-text-fill: #1E40AF;"/>
                <Label text="3. The system will automatically process and validate the records" 
                       style="-fx-text-fill: #1E40AF;"/>
                <Label text="4. Review any detected anomalies and make corrections if needed" 
                       style="-fx-text-fill: #1E40AF;"/>
            </VBox>
        </HBox>
    </VBox>
</VBox>
